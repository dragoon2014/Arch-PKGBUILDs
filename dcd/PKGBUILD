# $Id: PKGBUILD 163028 2016-02-21 15:17:34Z dicebot $
# Maintainer: Jaroslav Lichtblau <svetlemodry@archlinux.org>
# Contributor: Mihails Strasuns <public@dicebot.lv>

pkgname=dcd
pkgver=0.7.5
pkgrel=2
pkgdesc="D Completion Daemon: auto-complete for the D programming language"
groups=('dlang')
arch=('i686' 'x86_64')
url="https://github.com/Hackerpilot/DCD"
license=('GPL3')
depends=('liblphobos>=0.17.0')
makedepends=('ldc' 'git')
source=($pkgname-$pkgver::git+https://github.com/Hackerpilot/DCD#tag=v$pkgver
        dcd.service
        dcd.conf)
sha256sums=('SKIP'
            '7d3483ee92e42101d07395775aac5f0b277780f847c3823879fb35d1f2a9fbb3'
            'fb765020c49a918b157f5be2cabd71c16bbb050ddd762f1e08c84d1eddd4c97b')

prepare() {
  cd "${srcdir}"/$pkgname-$pkgver
  git submodule update --init --recursive
}  
            
build() {
  cd "${srcdir}"/$pkgname-$pkgver
  make ldc
}

package() {
  cd "${srcdir}"/$pkgname-$pkgver

# binaries
  install -Dm755 bin/dcd-server "${pkgdir}"/usr/bin/dcd-server
  install -Dm755 bin/dcd-client "${pkgdir}"/usr/bin/dcd-client

# documentation
  install -d "${pkgdir}"/usr/share/man/man1
  install -Dm644 man1/* "${pkgdir}"/usr/share/man/man1/

# systemd service
  install -Dm644 "${srcdir}"/dcd.service "${pkgdir}"/usr/lib/systemd/system/dcd.service

# global config
  install -Dm644 "${srcdir}"/dcd.conf "${pkgdir}"/etc/dcd.conf
}
